<!doctype html>
<html ng-app="myapp">
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.1.5/angular.min.js"></script>
      <script src="https://cdn.firebase.com/v0/firebase.js"></script>
      <script src="https://cdn.firebase.com/v0/firebase-simple-login.js"></script>
      <script src="https://cdn.firebase.com/libs/angularfire/0.3.0/angularfire.min.js"></script>
      
    <link rel="stylesheet" type="text/css" href="https://www.firebase.com/css/example.css">
  </head>
    <body ng-controller="MyController">
        <h1>ShowMe</h1>
        
        
        <span ng-show="user">
  {{user.name}} | <a ng-click="logout()">Logout</a>
</span>
<span ng-hide="user"><a ng-click="login()">Login</a></span>


        <div id="messagesDiv">
            <div ng-repeat="msg in messages"><em>{{msg.time}}-{{msg.name}}</em>: {{msg.desc}}</div>
        </div>
        
        <input type="text" ng-model="name" value="{{user.name}}" disabled >
        <input type="text" ng-model="time" placeholder="">
        <input type="text" ng-model="code" placeholder="">
        <input type="text" ng-model="codeType" placeholder="">
        <input type="text" ng-model="image" placeholder="">
        <input type="text" ng-model="desc" ng-keydown="addMessage($event)" placeholder="Message...">
        <script>
          
            var app = angular.module("myapp", ["firebase"]);

            function MyController($scope, angularFireAuth) {
                /*
                angularFireAuth.initialize(new Firebase("https://eysteinbye.firebaseio.com/showme"), {
                    scope: $rootScope,
                    name: 'user'
                });
                */
                var ref = new Firebase("https://eysteinbye.firebaseio.com/showme");
                angularFireAuth.initialize(ref, { scope: $scope, name: "user", messages: "messages" });
                
                $scope.messages = [];

                //angularFireAuth(ref, $scope, "messages");

                $scope.addMessage = function(e) {
                    if (e.keyCode != 13) return;

                    $scope.messages.push({
                        name: $scope.name,
                        time: $scope.time,
                        code: $scope.code,
                        codeType: $scope.codeType,
                        image: $scope.image,
                        desc: $scope.desc
                    });

                    $scope.desc = "";
                    $scope.time = "";
                    $scope.code = "";
                };
                
                $scope.login = function () {
                    angularFireAuth.login("facebook");
                };
                $scope.logout = function () {
                    angularFireAuth.logout();
                };
                
            }
          

        </script>
    </body>
</html>
